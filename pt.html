<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APLIKASI UJIAN</title>

    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: white;
        }

        .header {
            background: #510375;
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 22px;
            font-weight: bold;
        }

        iframe {
            width: 100vw;
            height: calc(100vh - 50px);
            border: none;
        }

        /* Halaman terkunci */
        #lockScreen {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: #b30000;
            color: white;
            text-align: center;
            padding-top: 80px;
            display: none;
            z-index: 9999;
        }

        #lockScreen input, 
        #lockScreen button {
            display: none;
            padding: 12px;
            font-size: 18px;
            width: 80%;
            max-width: 300px;
            border-radius: 6px;
            border: none;
            margin-top: 10px;
        }

        #lockScreen button {
            background: black;
            color: white;
            cursor: pointer;
        }

        /* Area rahasia di pojok kanan bawah */
        #secretArea {
            position: fixed;
            bottom: 0;
            right: 0;
            width: 90px;
            height: 90px;
            z-index: 10000;
            opacity: 0; /* tidak terlihat */
        }
    </style>
</head>
<body>

<div class="header">APLIKASI UJIAN</div>

<!-- GANTI GOOGLE FORM DI SINI -->
<iframe src="https://docs.google.com/forms/d/e/1FAIpQLSc3NoqtFNw_RHjwJLbmAvqyIL9WTuKY8RjZP5nZoshzGP1DuA/viewform?usp=header"></iframe>


<!-- Halaman terkunci -->
<div id="lockScreen">
    <h1>⚠️ HALAMAN UJIAN TERKUNCI</h1>
    <p>Sistem mendeteksi Anda keluar dari halaman ujian.</p>
    <p>Jangan keluar halaman selama ujian berlangsung.</p>

    <input type="password" id="kunci" placeholder="Masukkan kunci panitia">
    <button onclick="bukaUjian()">Buka Ujian</button>
</div>

<!-- Area rahasia → tekan 5 detik untuk admin -->
<div id="secretArea"></div>

<script>
/* ================================================
   MAPEL INFORMATIKA
   STORAGE KHUSUS MAPEL INI
   ================================================ */
const storageKey = "locked_pt";   // GANTI UNTUK MAPEL LAIN
const kunciPanitia = "SMK2024";            // Password admin



/* ============= Area Rahasia ============= */
let holdTimer = null;
const secretArea = document.getElementById("secretArea");

function showAdminPanel() {
    document.getElementById("kunci").style.display = "block";
    document.querySelector("#lockScreen button").style.display = "inline-block";
}

function startHold() {
    holdTimer = setTimeout(showAdminPanel, 5000); // 5 detik tahan
}
function endHold() {
    clearTimeout(holdTimer);
}

secretArea.addEventListener("mousedown", startHold);
secretArea.addEventListener("mouseup", endHold);
secretArea.addEventListener("touchstart", startHold);
secretArea.addEventListener("touchend", endHold);
secretArea.addEventListener("pointerdown", startHold);
secretArea.addEventListener("pointerup", endHold);



/* ============= Cek status kunci saat halaman dibuka ============= */
if (localStorage.getItem(storageKey) === "true") {
    munculKunci();
}



/* ============= Deteksi siswa keluar halaman ============= */
document.addEventListener("visibilitychange", function () {
    if (document.hidden) {
        localStorage.setItem(storageKey, "true");
        munculKunci();
    }
});



/* ============= Tampilkan layar kunci ============= */
function munculKunci() {
    document.getElementById("lockScreen").style.display = "block";
    document.body.style.overflow = "hidden";
}



/* ============= Buka kembali dengan kunci panitia ============= */
function bukaUjian() {
    const input = document.getElementById("kunci").value;

    if (input === kunciPanitia) {
        // Hapus kunci untuk mapel ini saja
        localStorage.removeItem(storageKey);

        document.getElementById("lockScreen").style.display = "none";
        document.body.style.overflow = "auto";

        document.getElementById("kunci").style.display = "none";
        document.querySelector("#lockScreen button").style.display = "none";
    } else {
        alert("❌ Kunci salah! Hubungi panitia.");
    }
}
</script>

</body>
</html>
